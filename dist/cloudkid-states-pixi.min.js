!function(){"use strict";var t=(cloudkid.Animator,cloudkid.PixiAnimator),n=cloudkid.StateManager,i=function(t){this.initialize(t)},e=i.prototype;e.addEventListener=null,e.removeEventListener=null,e.removeAllEventListeners=null,e.dispatchEvent=null,e.hasEventListener=null,e._listeners=null,createjs.EventDispatcher&&createjs.EventDispatcher.initialize(e),e.stateId=null,e.manager=null,e.panel=null,e._destroyed=!1,e._active=!1,e._isLoading=!1,e._canceled=!1,e._onEnterStateProceed=null,e._onLoadingComplete=null,e._enabled=!1,e._isTransitioning=!1,e.initialize=function(t){this.panel=t},e.getCanceled=function(){return this._canceled},e._internalExitState=function(){if(this._isTransitioning){this._isTransitioning=!1;var n=t.instance;n.stop(this.panel)}this._enabled=!1,this.panel.visible=!1,this._active=!1,this.exitState()},e.exitState=function(){},e._internalExitStateStart=function(){this.exitStateStart()},e.exitStateStart=function(){},e._internalEnterState=function(n){if(this._isTransitioning){this._isTransitioning=!1;var i=t.instance;i.stop(this.panel)}this._enabled=!1,this._active=!0,this._canceled=!1,this._onEnterStateProceed=n,this.enterState(),this._onEnterStateProceed&&(this._onEnterStateProceed(),this._onEnterStateProceed=null)},e.loadingStart=function(){return this._isLoading?(Debug.warn("loadingStart() was called while we're already loading"),void 0):(this._isLoading=!0,this.manager.loadingStart(),this._onLoadingComplete=this._onEnterStateProceed,this._onEnterStateProceed=null,void 0)},e.loadingDone=function(){return this._isLoading?(this._isLoading=!1,this.manager.loadingDone(),this._onLoadingComplete&&(this._onLoadingComplete(),this._onLoadingComplete=null),void 0):(Debug.warn("loadingDone() was called without a load started, call loadingStart() first"),void 0)},e._internalCancel=function(){this._active=!1,this._canceled=!0,this._isLoading=!1,this._internalExitState(),this.cancel()},e.cancel=function(){},e.enterState=function(){},e._internalEnterStateDone=function(){this._canceled||(this.setEnabled(!0),this.enterStateDone())},e.enterStateDone=function(){},e.update=function(){},e.getActive=function(){return this._active},e.transitionIn=function(i){this._isTransitioning=!0;var e=this,s=t.instance;s.play(this.panel,n.TRANSITION_IN,function(){e._isTransitioning=!1,i()})},e.transitionOut=function(i){this._enabled=!1,this._isTransitioning=!0;var e=this,s=t.instance;s.play(this.panel,n.TRANSITION_OUT,function(){e._isTransitioning=!1,i()})},e.getDestroyed=function(){return this._destroyed},e.setEnabled=function(t){this._enabled=t},e.getEnabled=function(){return this._enabled},e.destroy=function(){this.exitState(),this.panel=null,this.manager=null,this._destroyed=!0,this._onEnterStateProceed=null,this._onLoadingComplete=null},namespace("cloudkid").BaseState=i}(),function(t){"use strict";var n=function(t,n,i){this.initialize(t,n,i)},i=n.prototype;n.TRANSITION_IN="onTransitionStateIn",n.TRANSITION_IN_DONE="onTransitionStateInDone",n.TRANSITION_OUT="onTransitionStateOut",n.TRANSITION_OUT_DONE="onTransitionStateOutDone",n.VISIBLE="onVisible",n.HIDDEN="onHidden",i.currentState=null,i.visibleState=null,i.type=null,i.initialize=function(n,i,e){this.type=n,this.visibleState=e===t?i:e,this.currentState=i},namespace("cloudkid").StateEvent=n}(),function(t){"use strict";var n=cloudkid.Audio||cloudkid.Sound,i=cloudkid.OS,e=(cloudkid.Animator,cloudkid.BaseState,cloudkid.PixiAnimator),s=cloudkid.StateEvent,a=createjs.EventDispatcher,o=function(t,n){this.initialize(t,n)},r=o.prototype;r.addEventListener=null,r.removeEventListener=null,r.removeAllEventListeners=null,r.dispatchEvent=null,r.hasEventListener=null,r._listeners=null,a&&a.initialize(r),o.VERSION="1.1.4",r._transition=null,r._transitionSounds=null,r._states=null,r._state=null,r._stateId=null,r._oldState=null,r._isLoading=!1,r._isTransitioning=!1,r._destroyed=!1,r._queueStateId=null,o.TRANSITION_IN="onTransitionIn",o.TRANSITION_IN_DONE="onTransitionInDone",o.TRANSITION_OUT="onTransitionOut",o.TRANSITION_OUT_DONE="onTransitionOutDone",o.DIALOG_SHOW="onBlockerShow",o.DIALOG_SHOW_DONE="onBlockerShowDone",o.DIALOG_HIDE="onBlockerHide",o.DIALOG_HIDE_DONE="onBlockerHideDone",o.TRANSITION_INIT="onInit",o.TRANSITION_INIT_DONE="onInitDone",o.LOADING_START="onLoadingStart",o.LOADING_DONE="onLoadingDone",r.initialize=function(t,n){this._transition=t,this.hideBlocker(),this._states={},this._transitionSounds=n||null,this._loopTransition=this._loopTransition.bind(this)},r.addState=function(t,n){this._states[t]=n,n.stateId=t,n.manager=this,n._internalExitState()},r.changeTransition=function(t){this._transition=t},r.getState=function(){return this._stateId},r.getCurrentState=function(){return this._state},r.getStateById=function(n){return Debug.assert(this._states[n]!==t,"No alias matching "+n),this._states[n]},r.isBusy=function(){return this._isLoading||this._isTransitioning},r.loadingStart=function(){this._destroyed||(this.dispatchEvent(o.LOADING_START),this._loopTransition())},r.loadingDone=function(){this._destroyed||this.dispatchEvent(o.LOADING_DONE)},r.showBlocker=function(){var t=i.instance.stage;t.setInteractive(!1),t.forceUpdateInteraction()},r.hideBlocker=function(){var t=i.instance,n=t.stage;n.setInteractive(!0)},r.refresh=function(){Debug.assert(!!this._state,"No current state to refresh!"),this.setState(this._stateId)},r.setState=function(n){if(Debug.assert(this._states[n]!==t,"No current state mattching id '"+n+"'"),this._isTransitioning)return this._queueStateId=n,void 0;this._stateId=n,this.showBlocker(),this._oldState=this._state,this._state=this._states[n];var i;this._oldState?this._isLoading?(this._oldState._internalCancel(),this._isLoading=!1,this._state._internalEnterState(this._onStateLoaded)):(this._isTransitioning=!0,this._oldState._internalExitStateStart(),this.showBlocker(),i=this,this.dispatchEvent(new s(s.TRANSITION_OUT,this._state,this._oldState)),this._oldState.transitionOut(function(){i.dispatchEvent(new s(s.TRANSITION_OUT_DONE,i._state,i._oldState)),i.dispatchEvent(o.TRANSITION_OUT),i._transitioning(o.TRANSITION_OUT,function(){i.dispatchEvent(o.TRANSITION_OUT_DONE),i._isTransitioning=!1,i.dispatchEvent(new s(s.HIDDEN,i._state,i._oldState)),i._oldState.panel.visible=!1,i._oldState._internalExitState(),i._oldState=null,i._loopTransition(),i._processQueue()||(i._isLoading=!0,i._state._internalEnterState(i._onStateLoaded.bind(i)))})})):(this._isTransitioning=!0,this._transition.visible=!0,i=this,this._loopTransition(),i.dispatchEvent(o.TRANSITION_INIT_DONE),i._isLoading=!0,i._state._internalEnterState(i._onStateLoaded.bind(i)))},r._onStateLoaded=function(){this._isLoading=!1,this._isTransitioning=!0,this.dispatchEvent(new s(s.VISIBLE,this._state)),this._state.panel.visible=!0,this.dispatchEvent(o.TRANSITION_IN);var t=this;this._transitioning(o.TRANSITION_IN,function(){t._transition.visible=!1,t.dispatchEvent(o.TRANSITION_IN_DONE),t.dispatchEvent(new s(s.TRANSITION_IN,t._state)),t._state.transitionIn(function(){t.dispatchEvent(new s(s.TRANSITION_IN_DONE,t._state)),t._isTransitioning=!1,t.hideBlocker(),t._processQueue()||t._state._internalEnterStateDone()})})},r._processQueue=function(){if(this._queueStateId){var t=this._queueStateId;return this._queueStateId=null,this.setState(t),!0}return!1},r._loopTransition=function(){var t;this._transitionSounds&&(t=this._transitionSounds.loop,n.instance.soundLoaded===!1&&(t=null)),e.instance.instanceHasAnimation(this._transition,"transitionLoop")&&e.instance.play(this._transition,"transitionLoop",this._loopTransition,!1,1,0,t)},r.showTransitionOut=function(t){this.showBlocker();var n=this,i=function(){n._loopTransition(),t&&t()};this._transitioning(o.TRANSITION_OUT,i)},r.showTransitionIn=function(t){var n=this;this._transitioning(o.TRANSITION_IN,function(){n.hideBlocker(),t&&t()})},r._transitioning=function(t,i){var s=this._transition;s.visible=!0;var a;this._transitionSounds&&(a=t==o.TRANSITION_IN?this._transitionSounds.in:this._transitionSounds.out,n.instance.soundLoaded===!1&&(a=null)),e.instance.play(s,t,i,!1,1,0,a)},r.update=function(t){this._state&&this._state.update(t)},r.destroy=function(){if(this._destroyed=!0,e.instance.stop(this._transition),this._transition=null,this._state=null,this._oldState=null,this._states)for(var t in this._states)this._states[t].destroy(),delete this._states[t];this._states=null},namespace("cloudkid").StateManager=o}();